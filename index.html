<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Equation Hunt — Guess The X (24 symbols)</title>
  <style>
    :root{
      --bg:#f7efe6; /* nude */
      --card:#e6d7c7; /* lighter nude */
      --accent:#8b5e3c; /* brown */
      --accent-2:#a67c52; /* lighter brown */
      --muted:#bfae9a;
      --glass: rgba(255,255,255,0.6);
      font-family: 'Segoe UI', Roboto, system-ui, -apple-system, 'Noto Sans', sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; background:linear-gradient(180deg,var(--bg),#f2e9df);
      color:var(--accent); display:flex; flex-direction:column; align-items:center; gap:18px; padding:24px;
    }
    header{width:100%; max-width:1000px; display:flex; align-items:center; justify-content:space-between}
    h1{margin:0; font-size:20px}
    .sub{font-size:13px; color:var(--muted)}

    /* board */
    .board{width:100%; max-width:1000px; background:var(--card); border-radius:12px; padding:18px; box-shadow:0 6px 18px rgba(139,94,60,0.08)}
    .grid{display:grid; grid-template-columns:repeat(6,1fr); gap:12px}
    .card{background:var(--glass); border-radius:10px; height:110px; display:flex; flex-direction:column; align-items:center; justify-content:center; cursor:pointer; position:relative; transition:transform .12s ease, opacity .18s ease}
    .card:hover{transform:translateY(-6px)}
    .symbol{font-size:36px}
    .label{font-size:12px; margin-top:8px; color:var(--accent-2)}
    .eliminated{opacity:0.18; filter:grayscale(.9) blur(.6px); pointer-events:none}

    /* modal */
    .modal-bg{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.35); z-index:60}
    .modal{width:92%; max-width:520px; background:white; border-radius:12px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,0.25)}
    .modal h2{margin:0 0 8px 0; font-size:18px}
    .equation{font-weight:700; font-size:18px; color:var(--accent)}
    .controls{display:flex; gap:8px; margin-top:12px}
    input[type=text]{flex:1; padding:10px; border-radius:8px; border:1px solid #e6d7c7}
    button{background:var(--accent); color:white; border:none; padding:10px 12px; border-radius:8px; cursor:pointer}
    button.secondary{background:var(--accent-2)}
    .clue{margin-top:12px; font-size:14px; color:#5b3d2f}

    /* footer controls */
    .controls-bar{width:100%; max-width:1000px; display:flex; gap:8px; justify-content:space-between; align-items:center}
    .small{font-size:13px; color:var(--muted)}

    @media (max-width:700px){
      .grid{grid-template-columns:repeat(3,1fr)}
      .card{height:100px}
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>Equation Hunt — Guess The X</h1>
      <div class="sub">24 simbol — tema brown & nude • Klik simbol untuk dapatkan persamaan</div>
    </div>
    <div class="sub">Audio clues: enabled (Speech Synthesis)</div>
  </header>

  <main class="board" id="board">
    <div class="grid" id="grid"></div>
  </main>

  <div class="controls-bar">
    <div class="small">Tip: click simbol → solve equation → "Reveal Clue" → gunakan clue pada board fizikal untuk eliminate</div>
    <div>
      <button id="resetBtn" class="secondary">Reset Eliminations</button>
    </div>
  </div>

  <!-- modal -->
  <div class="modal-bg" id="modalBg">
    <div class="modal" role="dialog" aria-modal="true">
      <h2 id="modalTitle">Symbol</h2>
      <div class="equation" id="equationText">2x + 4 = 18</div>
      <div class="controls">
        <input id="answerInput" type="text" inputmode="numeric" placeholder="Masukkan nilai x">
        <button id="checkBtn">Check</button>
        <button id="eliminateBtn" class="secondary">Eliminate</button>
      </div>
      <div class="clue" id="clueText"></div>
      <div style="margin-top:12px; display:flex; gap:8px; justify-content:flex-end">
        <button id="closeBtn" class="secondary">Close</button>
      </div>
    </div>
  </div>

  <script>
    // ====== Configuration ======
    const NUM_CARDS = 24;
    const symbols = [
      '★','✿','⚑','✦','☾','✪','♞','✈','♣','☀','☕','♫',
      '♢','✺','✧','✺','✶','☂','♬','⚘','✿','❖','⚙','✿'
    ];

    // ====== Questions & Answers (from Alya) ======
    const qlist = [
      {question: "4x = 24. Find x.", answer: "x = 6"},
      {question: "3x = 18. Find x.", answer: "x = 6"},
      {question: "x/4 = 6. Find x.", answer: "x = 24"},
      {question: "x/3 = 5. Find x.", answer: "x = 15"},
      {question: "48x = 6. Find x.", answer: "x = 1/8"},
      {question: "6x + 4 = 24. Find x.", answer: "x = 10/3"},
      {question: "7x - 5 = 30. Find x.", answer: "x = 5"},
      {question: "3x + 2 = 20. Find x.", answer: "x = 6"},
      {question: "3x - 4 = 17. Find x.", answer: "x = 7"},
      {question: "x/5 + 3 = 6. Find x.", answer: "x = 15"},
      {question: "2x - 8 = 10. Find x.", answer: "x = 9"},
      {question: "24x= 17x - 13. Find x.", answer: "x = -13/7"},
      {question: "x/2 - 4 = 1. Find x.", answer: "x = 10"},
      {question: "5(x-3) + 7 = 20. Find x.", answer: "x = 28/5"},
      {question: "4(x-2) = 20. Find x.", answer: "x = 7"},
      {question: "2x + 3 = 4x - 5. Find x.", answer: "x = 4"},
      {question: "5x + 12 = 3x + 10. Find x.", answer: "x = -1"},
      {question: "8 + 3x = 2(x+10). Find x.", answer: "x = 12"},
      {question: "6x - 2 = 3x + 10. Find x.", answer: "x = 4"},
      {question: "4(x+3) - 2 = 2x + 20 . Find x.", answer: "x = 10"},
      {question: "5x + 11 = 13x - 7. Find x.", answer: "x = 9/4"},
      {question: "Bilangan kerusi di dalam sebuah dewan ialah 3 kali bilangan meja ditambah 12. Jika jumlah kerusi 48, cari bilangan meja. Find x.", answer: "x = 12"},
      {question: "Harga sehelai baju ialah Rm 5 lebih daripada empat kali harga topi. Jika harga baju ialah Rm 29, cari harga topi. Find x.", answer: "x = 6"},
      {question: "Puan Lina membeli x keping roti. Setiap keping roti berharga Rm2.50. Jika jumlah bayaran ialah Rm20, cari x. Find x.", answer: "x = 8"}
    ];

    // optional simple clues for each card (editable later)
    const baseClues = qlist.map((q,i)=>`Clue ${i+1}: simbol ${symbols[i % symbols.length]}`);

    // ====== DOM build ======
    const grid = document.getElementById('grid');
    const modalBg = document.getElementById('modalBg');
    const modalTitle = document.getElementById('modalTitle');
    const equationText = document.getElementById('equationText');
    const answerInput = document.getElementById('answerInput');
    const checkBtn = document.getElementById('checkBtn');
    const eliminateBtn = document.getElementById('eliminateBtn');
    const closeBtn = document.getElementById('closeBtn');
    const clueText = document.getElementById('clueText');
    const resetBtn = document.getElementById('resetBtn');

    let currentCard = null;
    const cardsData = [];

    function buildBoard(){
      for(let i=0;i<NUM_CARDS;i++){
        const d = {
          id:i,
          symbol: symbols[i % symbols.length],
          clue: baseClues[i],
          eliminated:false,
          question: qlist[i] ? qlist[i].question : `Soalan ${i+1}` ,
          answer: qlist[i] ? qlist[i].answer : `x = ?`
        };
        cardsData.push(d);
        const el = document.createElement('div');
        el.className='card';
        el.dataset.id = i;
        el.innerHTML = `<div class="symbol">${d.symbol}</div><div class="label">#${(i+1)}</div>`;
        el.addEventListener('click', ()=> openCard(i));
        grid.appendChild(el);
      }
    }

    // ====== Open card modal ======
    function openCard(id){
      currentCard = id;
      const card = cardsData[id];
      modalTitle.textContent = `Card #${id+1} — ${card.symbol}`;
      equationText.textContent = card.question;
      clueText.textContent = '';
      answerInput.value = '';
      eliminateBtn.style.display = 'inline-block';
      modalBg.style.display = 'flex';
      // speak short instruction in English
      speak(`Solve the questions. Enter the value of x. ${card.question}`);
      setTimeout(()=>answerInput.focus(),180);
    }

    // ====== Parse answer string ("x = 3" or "x = -13/7") to number ======
    function parseAnswerString(ansStr){
      if(!ansStr) return NaN;
      const parts = ansStr.split('=');
      let rhs = parts.length>1 ? parts[1].trim() : ansStr.trim();
      // remove optional 'Cari x.' etc
      rhs = rhs.replace(/[^0-9\-\/.]/g,'').trim();
      if(rhs.includes('/')){
        const fr = rhs.split('/');
        const num = Number(fr[0]);
        const den = Number(fr[1]);
        if(isNaN(num)||isNaN(den)||den===0) return NaN;
        return num/den;
      }
      const n = Number(rhs);
      return isNaN(n)?NaN:n;
    }

    // ====== Check answer ======
    checkBtn.addEventListener('click', ()=>{
      if(currentCard === null) return;
      const card = cardsData[currentCard];
      const correctVal = parseAnswerString(card.answer);
      const userVal = parseAnswerString(`x = ${answerInput.value.trim()}`);
      if(isNaN(userVal)){
        hintSpeak('Please enter a valid number.');
        clauseShow('Please enter a valid number.');
        return;
      }
      // compare with tolerance
      const ok = Math.abs(userVal - correctVal) < 1e-9;
      if(ok){
        const clue = `Correct answer: ${card.answer}. ${card.clue}`;
        clueText.textContent = clue;
        speak(`Correct. ${card.answer}`);
        const node = grid.querySelector(`[data-id="${currentCard}"]`);
        node.style.boxShadow = 'inset 0 0 0 3px rgba(139,94,60,0.12)';
      } else {
        clauseShow('Wrong answer. Try again.');
        hintSpeak('Wrong answer. Try again.');
      }
    });

    function clauseShow(text){
      clueText.textContent = text;
    }

    // ====== Eliminate ======
    eliminateBtn.addEventListener('click', ()=>{
      if(currentCard === null) return;
      const node = grid.querySelector(`[data-id="${currentCard}"]`);
      node.classList.toggle('eliminated');
      cardsData[currentCard].eliminated = node.classList.contains('eliminated');
      speak(cardsData[currentCard].eliminated ? 'Eliminated' : 'Restored');
    });

    closeBtn.addEventListener('click', ()=>{ modalBg.style.display='none'; currentCard=null; });
    modalBg.addEventListener('click', (e)=>{ if(e.target===modalBg){ modalBg.style.display='none'; currentCard=null;} });

    resetBtn.addEventListener('click', ()=>{
      grid.querySelectorAll('.card').forEach(n=> n.classList.remove('eliminated'));
      cardsData.forEach(d=>d.eliminated=false);
      speak('All eliminations have been reset');
    });

    // ====== Speech helpers (use Web Speech API) ======
    function speak(text){
      if(!('speechSynthesis' in window)) return;
      const ut = new SpeechSynthesisUtterance(text);
      ut.rate = 0.95; ut.pitch = 1; ut.lang = 'ms-MY';
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(ut);
    }
    function hintSpeak(text){
      if(!('speechSynthesis' in window)) return;
      const ut = new SpeechSynthesisUtterance(text);
      ut.rate = 1.0; ut.pitch = 1.1; ut.lang = 'ms-MY';
      window.speechSynthesis.speak(ut);
    }

    // ====== Init ======
    buildBoard();

  </script>
</body>
</html>
